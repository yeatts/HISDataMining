---
title: "HPMT 5335 - Assignment 1"
author: "Evan Munro and Jeremy Yeatts"
date: "3/4/2021"
output: 
  prettydoc::html_pretty:
    theme: cayman
    toc: true
    toc_depth: 3
---

```{r include = F}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, fig.align='center')
```
***

## **Question 1 (15 points):** 
#### **Please refer to “heart” data in package “catdata”. We want to compare the adiposity between heart disease and no heart disease.**

Loading data:
```{r}
library(catdata)
library(dplyr)
data(heart)
```
***

### **(1)** 
#### **Plot a box plot to show the adiposity between heart disease and no heart disease. Do these two groups have different distributions of adiposity in terms of mean and range? Briefly describe what you find in this box plot.**

```{r}
heart_df = data.frame(heart)
summary(heart_df)

boxplot(data=heart_df,
		adiposity ~ y,
		main="Adiposity between heart disease and no heart disease",
		xlab = "Heart Disease",
		names = c("No", "Yes"))
  
```

The group with heart disease has a distribution of adiposity scores that shows higher scores at every quartile. The mean adiposity score is higher in the group with heart disease, and the range of adiposity scores is smaller for the heart disease group.

***

### **(2)** 
#### **Do a pooled T-test and see if the means of adiposity between two groups are significantly different. What is the null hypothesis? What is the p-value and what is the 95% confidence interval?**

```{r}
t.test(x = subset(heart_df$adiposity, heart_df$y==1),
		y = subset(heart_df$adiposity, heart_df$y==0),
		alternative = "two.sided",
		conf.level = 0.95,
		var.equal = T)
```
Null hypothesis: **$H_0: \mu_0 - \mu_1 = 0$**\
p-value: **3.051e-08**\
95 percent confidence interval: **2.703560  5.598728**\

***
### **(3)** 
#### **Do a F test to see if the variances of adiposity between two groups are significantly different if we use $\alpha=0.05$. What is the null hypothesis? What is the p-value and what is the 95% confidence interval?**

```{r}
var.test(x = subset(heart_df$adiposity, heart_df$y==1),
			y = subset(heart_df$adiposity, heart_df$y==0),         
			alternative = "two.sided", 
			conf.level = 0.95)
```
***
Null hypothesis: **$H_0: \sigma_1^2 = \sigma_2^2$**\
p-value: **0.1734**\
95 percent confidence interval: **0.6314759  1.0891395**\

## **Question 2 (15 points):** \
#### **Please refer to “birth” data in package “catdata”. Only use the data where the country is France. We want to know if the weight of babies has the association with cesarean or not in France. **
***

```{r}
# install.packages(c("ggpubr"))
library(ggpubr)
data(birth)
FrenchBabes = filter(birth, Country == 'FR')
```


### **(1)** 
#### **Add a new column “BWeightG” to group to babies’ weights into three groups: $Weight \le 2500 g$, $2500 g < Weight \le 4000 g$, and $Weight > 4000 g$.**

```{r}
FrenchBabes %>%
  mutate(BWeightG = case_when(Weight <= 2500 ~ '(0, 2500]', 
                            Weight > 2500 & Weight <= 4000 ~ '(2500, 4000]', 
                            Weight > 4000 ~ '(4000, inf)')) -> FrenchBabes
```

***

### **(2)** 
#### **Plot a stacked bar plot where x axis is the baby weight’s group $(\le 2500$, $(2500, 4000]$, and $> 4000)$, and y axis is the number of babies who are were born by cesarean. Brief describe what you find in the bar plot.**

```{r}
FrenchBabes$Cesarean = as.factor(FrenchBabes$Cesarean)
ggplot(FrenchBabes, aes(x = BWeightG, fill = Cesarean)) + 
  geom_bar(position = "stack") +
  scale_fill_discrete(name = "Cesarean", labels = c("No", "Yes")) +
  ggtitle("Number of babies born by weight and delivery method")

```
The majority of babies born are delivered without a cesarean section, and the majority of babies born weigh between 2500 and 4000 grams. It also appears that a cesarean section is most likely when babies weigh less than 2500 grams at birth.

***
### **(3)** 
#### **Do a Chi-square test to see if the association between baby’s weight and cesarean is significant if we use $\alpha=0.05$. Show the observed table and the expected table. What is the degrees of freedom? What is the p-value?**

```{r}
chi = chisq.test(FrenchBabes$BWeightG, FrenchBabes$Cesarean)
chi
chi$observed
chi$expected
```
The association between baby's weight and cesarean is significant with $\alpha=0.05$.
The degrees of freedom is df = 2.  
The p-value is 3.931e-06. 

***

## **Question 3 (10 points):** 
#### **Please refer to “diet_data” which was posted on Blackboard. We want to see if consuming wine and weight-based exercise would affect the means of weight changes. Before the analysis, be sure to delete the rows with missing value in column “change”.**

***
Preprocessing
```{r}
diet_data = read.csv("HW2_diet_data.csv")
dd = diet_data[!is.na(diet_data$change),] # [row, columns]
```

### **(1)** 
#### **Plot a box plot with points representing the means to show the distribution of weight changes (changes) of consuming wine (wine) without weight-based exercise (weight), consuming wine with weight-based exercise, not consuming wine without weight-based exercise and not consuming wine with weight-based exercise. Briefly describe what you find in the box plot.**

```{r}
summary(dd)
wine_yes = filter(dd, dd$wine==1)
wine_no = filter(dd, dd$wine==0)

wine_yes_weight_yes = filter(wine_yes, wine_yes$weight==1)
wine_yes_weight_no = filter(wine_yes, wine_yes$weight==0)
wine_no_weight_yes = filter(wine_no, wine_no$weight==1)
wine_no_weight_no = filter(wine_no, wine_no$weight==0)

{
boxplot(data= wine_yes,
		change ~ weight,
		main="consuming wine",
		names= c("without weight-based exercies", "with weight-based exercies"))
points(c(mean(wine_yes_weight_yes$change), mean(wine_yes_weight_no$change)), col="red")
}
{
boxplot(data=wine_no,
		change ~ weight,
		main="NOT consuming wine",
		names= c("without weight-based exercies", "with weight-based exercies"))
points(c(mean(wine_no_weight_yes$change), mean(wine_no_weight_no$change)), col="red")
}
```
There isn't much weight changes with and without comsuming wine with and without weight-based exercies

***

### **(2)** 
#### **Do a two-way ANOVA (analysis of variance) to see if weight-based exercise and consuming wine affect the means of weight changes. What conclusions can you make from the ANOVA test results and why?**

```{r}
aov2 = aov(change ~ weight * wine, data=dd)
aov2
summary(aov2)

# interpreting 2 way anova in r
```
There was not a statistically significant interaction between the effects of weight-based exercies and wine on weight change. Wine consuption is significant with a p-value of 0.01. 

***

## **Question 4 (20 points):** 
#### **Please refer to “diet_data” (HW2_diet_data.csv) which was posted on Blackboard.**

***

### **(1)** 
#### **Do a linear regression using Excel and R to see if calories consuming per ounce daily would be able to predict daily weight changes. You will get a couple of tables in the results. Explain what the ANOVA table tells you. And explain what the coefficient table tells you. What are the confidence intervals of intercept $\beta_0$ and the slope $\beta_1$ if we set up the confidence level to be 95%? What is the value of R squared and what does the R squared tell you?**

![Excel Tables](dd_reg_tables.png)

```{r}

```

***

### **(2)** 
#### **Plot a scatter plot using R where x-axis is calories consuming per ounce and y-axis is weight changes. On the plot, add the regression line from (1). (hint: use function abline())**

```{r}

```

***
### **(3)** 
#### **Check if your simple linear meets the assumptions regarding residuals using R. There are 4 assumptions for residuals.**  
*	**The mean of residuals is zero.**  
*	**The variances of residuals are equal for all predicted values (Homoscedasticity of residuals).**  
*	**Residuals follow normal distribution.**  
*	**X and residuals are uncorrelated.**  

```{r}

```

***
### **(4)** 
#### **Do a multivariate linear regression using R to see if calories consuming per ounce daily, main meal was bag of five jam donuts, walk, and one large glass of wine would be able to predict daily weight changes. Compare this model with the one you get from Part (1).**

```{r}

```

***





## **Question 5 (40 points):** 
#### **Please refer to heart failure data set (HW2_heart_failure_dataset.csv) that consists of 299 samples with 13 features.**

***

### **(1)** 
#### **Load in the data using read.csv(). Do hierarchical clustering with complete linkage and Euclidean distance.**

```{r}
hf_data = read.csv("HW2_heart_failure_dataset.csv")
```

***

### **(2)** 
#### **Plot the dendrogram and cut the dendrogram at a height that results in three distinct clusters.**

```{r}

```

***
### **(3)** 
#### **Perform K-means clustering of the observations with $K = 3$. How well do the clusters that you obtained in K-means clustering compare to the true class labels?**  

```{r}

```

***
### **(4)** 
#### **Perform K-means clustering with $K = 2$ and $K=4$. Describe your results. How many clusters would you recommend based on elbow method?**

```{r}

```

***




</br>
</br>
</br>
</br>
















